!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?(t.disabled=!0,t.classList.add(r.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},r=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)};function n(e,t,r,n){t&&(t.textContent=e?n:r)}let o=null,a=null,l=null;const s=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t={}){return fetch(`${this._baseUrl}${e}`,{headers:this._headers,...t}).then(e=>this._checkResponse(e))}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getUserInfo(){return this._request("/users/me")}setUpdateUserInfo({name:e,about:t}){return this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:e,about:t})})}updateAvatar(e){return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:e})})}getInitialCards(){return this._request("/cards")}addCard({name:e,link:t}){return this._request("/cards",{method:"POST",body:JSON.stringify({name:e,link:t})})}deleteCard(e){return this._request(`/cards/${e}`,{method:"DELETE"})}changeLikeCardStatus(e,t){return this._request(`/cards/${e}/likes`,{method:t?"PUT":"DELETE"})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"cf143ddc-e5b7-44f2-b563-374f81cfb9fa","Content-Type":"application/json"}}),c=document.querySelector(".profile__edit-button"),i=document.querySelector("#edit-profile-modal"),d=i.querySelector(".modal__close-button"),u=i.querySelector(".modal__form"),m=i.querySelector("#profile-name-input"),_=i.querySelector("#profile-description-input"),v=u.querySelector(".modal__submit-button"),S=document.querySelector("#new-post-modal"),y=S.querySelector(".modal__form"),p=S.querySelector("#card-caption-input"),f=S.querySelector("#card-image-input"),b=document.querySelector(".profile__add-button"),q=y.querySelector(".modal__submit-button"),h=S.querySelector(".modal__close-button"),L=document.querySelector(".profile__avatar-button"),E=document.querySelector("#preview-modal"),k=E.querySelector(".modal__close-button"),C=E.querySelector(".modal__image"),g=E.querySelector(".modal__caption"),w=document.querySelector(".profile__name"),x=document.querySelector(".profile__description"),U=document.querySelector(".profile__avatar"),A=document.querySelector("#delete-card-modal"),D=A?A.querySelector(".modal__form"):null,I=D?D.querySelector(".modal__submit-button"):null,B=A?A.querySelector(".modal__close-button"):null,T=document.querySelector("#delete-cancel-button"),$=document.querySelector("#avatar-modal"),P=$?$.querySelector(".modal__form"):null,j=P?P.querySelector("#avatar-link-input"):null,N=P?P.querySelector(".modal__submit-button"):null,O=$?$.querySelector(".modal__close-button"):null,J=document.querySelector("#card-template"),H=document.querySelector(".cards__list");function R(e){if("Escape"===e.key){const e=document.querySelector(".modal_is-opened");e&&M(e)}}function Y(e){e.target.classList.contains("modal")&&M(e.target)}function z(e){e.classList.add("modal_is-opened"),e.addEventListener("mousedown",Y),document.addEventListener("keydown",R)}function M(e){e.classList.remove("modal_is-opened"),e.removeEventListener("mousedown",Y),document.removeEventListener("keydown",R)}function F(e){const t=J.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),c=t.querySelector(".card__link-button"),i=t.querySelector(".card__delete-button");n.src=e.link,n.alt=e.name,r.textContent=e.name;const d=e.owner&&"object"==typeof e.owner?e.owner._id:e.owner;return d&&o&&d!==o&&(i.style.display="none"),Boolean(e.isLiked)&&c.classList.add("card__link-button_active"),c.addEventListener("click",()=>{const t=!c.classList.contains("card__link-button_active");s.changeLikeCardStatus(e._id,t).then(e=>{e.isLiked?c.classList.add("card__link-button_active"):c.classList.remove("card__link-button_active")}).catch(console.error)}),i.addEventListener("click",()=>{!function(e,t){a=e,l=t._id,z(A)}(t,e)}),n.addEventListener("click",()=>{C.src=e.link,g.textContent=e.name,C.alt=e.name,z(E)}),t}var G;u.addEventListener("submit",e=>{e.preventDefault();const t=m.value,r=_.value;n(!0,v,"Save","Saving..."),s.setUpdateUserInfo({name:t,about:r}).then(e=>{w.textContent=e.name,x.textContent=e.about,M(i)}).catch(console.error).finally(()=>{n(!1,v,"Save","Saving...")})}),y.addEventListener("submit",t=>{t.preventDefault();const o=p.value,a=f.value;n(!0,q,"Save","Saving..."),s.addCard({name:o,link:a}).then(t=>{!function(e){const t=F(e);H.prepend(t)}(t),y.reset(),r(q,e),M(S)}).catch(console.error).finally(()=>{n(!1,q,"Save","Saving...")})}),P&&j&&N&&P.addEventListener("submit",t=>{t.preventDefault();const o=j.value;n(!0,N,"Save","Saving..."),s.updateAvatar(o).then(t=>{U.src=t.avatar,P.reset(),r(N,e),M($)}).catch(console.error).finally(()=>{n(!1,N,"Save","Saving...")})}),D&&I&&D.addEventListener("submit",e=>{e.preventDefault(),l&&(n(!0,I,"Yes, delete","Deleting..."),s.deleteCard(l).then(()=>{a&&a.remove(),a=null,l=null,M(A)}).catch(console.error).finally(()=>{n(!1,I,"Yes, delete","Deleting...")}))}),c.addEventListener("click",()=>{m.value=w.textContent,_.value=x.textContent,z(i)}),d.addEventListener("click",()=>{M(i)}),b.addEventListener("click",()=>{z(S)}),h.addEventListener("click",()=>{M(S)}),L&&$&&P&&N&&L.addEventListener("click",()=>{z($)}),O&&O.addEventListener("click",()=>{M($)}),B&&B.addEventListener("click",()=>{M(A)}),T&&T.addEventListener("click",()=>{M(A)}),k.addEventListener("click",()=>{M(E)}),s.getAppInfo().then(([e,t])=>{o=e._id,w.textContent=e.name,x.textContent=e.about,U.src=e.avatar,t.forEach(e=>{!function(e){const t=F(e);H.append(t)}(e)})}).catch(console.error),G=e,document.querySelectorAll(G.formSelector).forEach(e=>{((e,r)=>{const n=Array.from(e.querySelectorAll(r.inputSelector)),o=e.querySelector(r.submitButtonSelector);t(n,o,r),n.forEach(a=>{a.addEventListener("input",()=>{((e,t,r)=>{t.validity.valid?((e,t,r)=>{const n=e.querySelector(`#${t.id}-error`);n&&(n.textContent="",n.classList.remove(r.errorClass)),t.classList.remove(r.inputErrorClass)})(e,t,r):((e,t,r)=>{const n=e.querySelector(`#${t.id}-error`);n&&(n.textContent=t.validationMessage,n.classList.add(r.errorClass)),t.classList.add(r.inputErrorClass)})(e,t,r)})(e,a,r),t(n,o,r)})})})(e,G)})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVN0SixLQUN2QyxNQUFNeUosRUFBYVAsRUFBT3BGLGNBQWUsSUFBR3dGLEVBQVFJLFlBQ2hERCxJQUNGQSxFQUFXekksWUFBY3NJLEVBQVFNLGtCQUNqQ0gsRUFBV2xKLFVBQVVDLElBQUlSLEVBQU9KLGFBRWxDMEosRUFBUS9JLFVBQVVDLElBQUlSLEVBQU9MLGtCQWMzQmdLLENBQWVULEVBQVFJLEVBQVN0SixJQStCOUJ1SixDQUFtQkwsRUFBUUksRUFBU3RKLEdBQ3BDSCxFQUFrQkMsRUFBV0MsRUFBVUMsUUFRekNtSixDQUFpQkQsRUFBUWxKLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJwYWNrLWRlbW8vLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3dlYnBhY2stZGVtby8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJwYWNrLWRlbW8vLi9zcmMvdXRpbC9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICBpZiAoZXJyb3JNc2dFbCkge1xyXG4gICAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1zZ0VsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gIH1cclxuICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICBpZiAoZXJyb3JNc2dFbCkge1xyXG4gICAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1zZ0VsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gIH1cclxuICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+ICFpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpID0+IHtcclxuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIGJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25FbC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgYnV0dG9uRWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG59O1xyXG5leHBvcnQgY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbCwgY29uZmlnKSA9PiB7XHJcbiAgYnV0dG9uRWwuZGlzYWJsZWQgPSB0cnVlO1xyXG4gIGJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lciA9IChmb3JtRWwsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICBjb25zdCBidXR0b25FbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZyk7XHJcblxyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcclxuICAgIHNldEV2ZW50TGlzdGVuZXIoZm9ybUVsLCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG4iLCJpbXBvcnQgQXBpIGZyb20gXCIuLi91dGlsL0FwaS5qc1wiO1xuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICB2YWxpZGF0aW9uQ29uZmlnLFxuICBkaXNhYmxlQnV0dG9uLFxuICBlbmFibGVWYWxpZGF0aW9uLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uXCI7XG5cbi8vIC0tLS0tLS0tLSBIRUxQRVIgRk9SIFwiU2F2aW5nLi4uXCIgLyBcIkRlbGV0aW5nLi4uXCIgLS0tLS0tLS0tXG5mdW5jdGlvbiByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgYnV0dG9uLCBkZWZhdWx0VGV4dCwgbG9hZGluZ1RleHQpIHtcbiAgaWYgKCFidXR0b24pIHJldHVybjtcbiAgYnV0dG9uLnRleHRDb250ZW50ID0gaXNMb2FkaW5nID8gbG9hZGluZ1RleHQgOiBkZWZhdWx0VGV4dDtcbn1cblxuLy8gLS0tLS0tLS0tIEdMT0JBTCBTVEFURSAtLS0tLS0tLS1cbmxldCBjdXJyZW50VXNlcklkID0gbnVsbDtcbmxldCBzZWxlY3RlZENhcmQgPSBudWxsO1xubGV0IHNlbGVjdGVkQ2FyZElkID0gbnVsbDtcblxuLy8gLS0tLS0tLS0tIEFQSSBJTlNUQU5DRSAtLS0tLS0tLS1cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImNmMTQzZGRjLWU1YjctNDRmMi1iNTYzLTM3NGY4MWNmYjlmYVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbi8vIC0tLS0tLS0tLSBET00gRUxFTUVOVFMgLS0tLS0tLS0tXG5cbi8vIFByb2ZpbGUgbW9kYWxcbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcbmNvbnN0IGVkaXRQcm9maWxlQ2xvc2VCdXR0b24gPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIixcbik7XG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBlZGl0UHJvZmlsZU5hbWVJbnB1dCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIsXG4pO1xuY29uc3QgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCIsXG4pO1xuY29uc3QgZWRpdFByb2ZpbGVTdWJtaXRCdXR0b24gPSBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcbik7XG5cbi8vIE5ldyBwb3N0IChjYXJkKSBtb2RhbFxuY29uc3QgbmV3UG9zdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXctcG9zdC1tb2RhbFwiKTtcbmNvbnN0IGFkZENhcmRGb3JtRWwgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IG5ld1Bvc3RDYXB0aW9uSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLWNhcHRpb24taW5wdXRcIik7XG5jb25zdCBuZXdQb3N0SW1hZ2VJbnB1dCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2UtaW5wdXRcIik7XG5jb25zdCBuZXdQb3N0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuY29uc3QgY2FyZFN1Ym1pdEJ1dHRvbiA9IGFkZENhcmRGb3JtRWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcbmNvbnN0IG5ld1Bvc3RDbG9zZUJ1dHRvbiA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XG5cbi8vIEF2YXRhciBlZGl0XG5jb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xuXG4vLyBQcmV2aWV3IG1vZGFsXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3Q2xvc2VCdG4gPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xuY29uc3QgcHJldmlld0ltYWdlRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3TmFtZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG5cbi8vIFByb2ZpbGUgdGV4dCArIGF2YXRhciBvbiBwYWdlXG5jb25zdCBwcm9maWxlTmFtZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcHJvZmlsZUF2YXRhckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XG5cbi8vIERlbGV0ZSBjb25maXJtYXRpb24gcG9wdXBcbmNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGRlbGV0ZUZvcm0gPSBkZWxldGVNb2RhbFxuICA/IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIilcbiAgOiBudWxsO1xuY29uc3QgZGVsZXRlU3VibWl0QnV0dG9uID0gZGVsZXRlRm9ybVxuICA/IGRlbGV0ZUZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKVxuICA6IG51bGw7XG5jb25zdCBkZWxldGVDbG9zZUJ1dHRvbiA9IGRlbGV0ZU1vZGFsXG4gID8gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpXG4gIDogbnVsbDtcbmNvbnN0IGNhbmNlbERlbGV0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWNhbmNlbC1idXR0b25cIik7XG5cbi8vIEF2YXRhciBtb2RhbFxuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcbmNvbnN0IGF2YXRhckZvcm0gPSBhdmF0YXJNb2RhbFxuICA/IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIilcbiAgOiBudWxsO1xuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJGb3JtXG4gID8gYXZhdGFyRm9ybS5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1saW5rLWlucHV0XCIpXG4gIDogbnVsbDtcbmNvbnN0IGF2YXRhclN1Ym1pdEJ1dHRvbiA9IGF2YXRhckZvcm1cbiAgPyBhdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIilcbiAgOiBudWxsO1xuY29uc3QgYXZhdGFyQ2xvc2VCdXR0b24gPSBhdmF0YXJNb2RhbFxuICA/IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKVxuICA6IG51bGw7XG5cbi8vIENhcmRzXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG4vLyAtLS0tLS0tLS0gTU9EQUwgSEVMUEVSUyAtLS0tLS0tLS1cblxuZnVuY3Rpb24gaGFuZGxlRXNjYXBlKGV2dCkge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9pcy1vcGVuZWRcIik7XG4gICAgaWYgKG9wZW5lZE1vZGFsKSB7XG4gICAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFuZGxlT3ZlcmxheUNsb3NlKGV2dCkge1xuICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSkge1xuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9pcy1vcGVuZWRcIik7XG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgaGFuZGxlT3ZlcmxheUNsb3NlKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZU92ZXJsYXlDbG9zZSk7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XG59XG5cbi8vIC0tLS0tLS0tLSBDQVJEIEhFTFBFUlMgLS0tLS0tLS0tXG5cbi8vIEZvciB0aGlzIEFQSSwgaXNMaWtlZCBpcyBhIGJvb2xlYW4gb24gdGhlIGNhcmQgb2JqZWN0XG5mdW5jdGlvbiBpc0NhcmRMaWtlZChjYXJkKSB7XG4gIHJldHVybiBCb29sZWFuKGNhcmQuaXNMaWtlZCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpIHtcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XG4gIHNlbGVjdGVkQ2FyZElkID0gZGF0YS5faWQ7XG4gIG9wZW5Nb2RhbChkZWxldGVNb2RhbCk7XG59XG5cbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gIGNvbnN0IGNhcmRUaXRsZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICBjb25zdCBsaWtlQnV0dG9uRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpbmstYnV0dG9uXCIpO1xuICBjb25zdCBkZWxldGVCdXR0b25FbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcblxuICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcbiAgY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG5cbiAgLy8gT3duZXIgbWF5IGJlIGFuIElEIHN0cmluZyBvciBhbiBvYmplY3QsIGhhbmRsZSBib3RoIGRlZmVuc2l2ZWx5XG4gIGNvbnN0IG93bmVySWQgPVxuICAgIGRhdGEub3duZXIgJiYgdHlwZW9mIGRhdGEub3duZXIgPT09IFwib2JqZWN0XCIgPyBkYXRhLm93bmVyLl9pZCA6IGRhdGEub3duZXI7XG5cbiAgaWYgKG93bmVySWQgJiYgY3VycmVudFVzZXJJZCAmJiBvd25lcklkICE9PSBjdXJyZW50VXNlcklkKSB7XG4gICAgZGVsZXRlQnV0dG9uRWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICB9XG5cbiAgaWYgKGlzQ2FyZExpa2VkKGRhdGEpKSB7XG4gICAgbGlrZUJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saW5rLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH1cblxuICBsaWtlQnV0dG9uRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjb25zdCBzaG91bGRMaWtlID0gIWxpa2VCdXR0b25FbC5jbGFzc0xpc3QuY29udGFpbnMoXG4gICAgICBcImNhcmRfX2xpbmstYnV0dG9uX2FjdGl2ZVwiLFxuICAgICk7XG5cbiAgICBhcGlcbiAgICAgIC5jaGFuZ2VMaWtlQ2FyZFN0YXR1cyhkYXRhLl9pZCwgc2hvdWxkTGlrZSlcbiAgICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xuICAgICAgICBpZiAodXBkYXRlZENhcmQuaXNMaWtlZCkge1xuICAgICAgICAgIGxpa2VCdXR0b25FbC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGluay1idXR0b25fYWN0aXZlXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxpa2VCdXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGluay1idXR0b25fYWN0aXZlXCIpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuICB9KTtcblxuICBkZWxldGVCdXR0b25FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpO1xuICB9KTtcblxuICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHByZXZpZXdJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcbiAgICBwcmV2aWV3TmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBhZGRDYXJkVG9TdGFydChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmREYXRhKTtcbiAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xufVxuXG5mdW5jdGlvbiBhZGRDYXJkVG9FbmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkRGF0YSk7XG4gIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xufVxuXG4vLyAtLS0tLS0tLS0gRk9STSBIQU5ETEVSUyAtLS0tLS0tLS1cblxuLy8gRWRpdCBwcm9maWxlXG5lZGl0UHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IG5hbWUgPSBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZTtcbiAgY29uc3QgYWJvdXQgPSBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWU7XG5cbiAgcmVuZGVyTG9hZGluZyh0cnVlLCBlZGl0UHJvZmlsZVN1Ym1pdEJ1dHRvbiwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xuXG4gIGFwaVxuICAgIC5zZXRVcGRhdGVVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pXG4gICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gICAgICBwcm9maWxlTmFtZUVsLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbkVsLnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XG4gICAgICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgZWRpdFByb2ZpbGVTdWJtaXRCdXR0b24sIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcbiAgICB9KTtcbn0pO1xuXG4vLyBBZGQgbmV3IGNhcmRcbmFkZENhcmRGb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IG5hbWUgPSBuZXdQb3N0Q2FwdGlvbklucHV0LnZhbHVlO1xuICBjb25zdCBsaW5rID0gbmV3UG9zdEltYWdlSW5wdXQudmFsdWU7XG5cbiAgcmVuZGVyTG9hZGluZyh0cnVlLCBjYXJkU3VibWl0QnV0dG9uLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XG5cbiAgYXBpXG4gICAgLmFkZENhcmQoeyBuYW1lLCBsaW5rIH0pXG4gICAgLnRoZW4oKG5ld0NhcmQpID0+IHtcbiAgICAgIGFkZENhcmRUb1N0YXJ0KG5ld0NhcmQpO1xuICAgICAgYWRkQ2FyZEZvcm1FbC5yZXNldCgpO1xuICAgICAgZGlzYWJsZUJ1dHRvbihjYXJkU3VibWl0QnV0dG9uLCB2YWxpZGF0aW9uQ29uZmlnKTtcbiAgICAgIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIGNhcmRTdWJtaXRCdXR0b24sIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcbiAgICB9KTtcbn0pO1xuXG4vLyBVcGRhdGUgYXZhdGFyXG5pZiAoYXZhdGFyRm9ybSAmJiBhdmF0YXJJbnB1dCAmJiBhdmF0YXJTdWJtaXRCdXR0b24pIHtcbiAgYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IGF2YXRhclVybCA9IGF2YXRhcklucHV0LnZhbHVlO1xuXG4gICAgcmVuZGVyTG9hZGluZyh0cnVlLCBhdmF0YXJTdWJtaXRCdXR0b24sIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcblxuICAgIGFwaVxuICAgICAgLnVwZGF0ZUF2YXRhcihhdmF0YXJVcmwpXG4gICAgICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICAgICAgcHJvZmlsZUF2YXRhckVsLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcbiAgICAgICAgYXZhdGFyRm9ybS5yZXNldCgpO1xuICAgICAgICBkaXNhYmxlQnV0dG9uKGF2YXRhclN1Ym1pdEJ1dHRvbiwgdmFsaWRhdGlvbkNvbmZpZyk7XG4gICAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBhdmF0YXJTdWJtaXRCdXR0b24sIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuLy8gRGVsZXRlIGNhcmQgKGNvbmZpcm0pXG5pZiAoZGVsZXRlRm9ybSAmJiBkZWxldGVTdWJtaXRCdXR0b24pIHtcbiAgZGVsZXRlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoIXNlbGVjdGVkQ2FyZElkKSByZXR1cm47XG5cbiAgICByZW5kZXJMb2FkaW5nKHRydWUsIGRlbGV0ZVN1Ym1pdEJ1dHRvbiwgXCJZZXMsIGRlbGV0ZVwiLCBcIkRlbGV0aW5nLi4uXCIpO1xuXG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChzZWxlY3RlZENhcmRJZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgaWYgKHNlbGVjdGVkQ2FyZCkge1xuICAgICAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxlY3RlZENhcmQgPSBudWxsO1xuICAgICAgICBzZWxlY3RlZENhcmRJZCA9IG51bGw7XG4gICAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBkZWxldGVTdWJtaXRCdXR0b24sIFwiWWVzLCBkZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuLy8gLS0tLS0tLS0tIEJVVFRPTiAvIE1PREFMIE9QRU4gJiBDTE9TRSBMSVNURU5FUlMgLS0tLS0tLS0tXG5cbi8vIE9wZW4gcHJvZmlsZSBlZGl0XG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lRWwudGV4dENvbnRlbnQ7XG4gIGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbkVsLnRleHRDb250ZW50O1xuICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59KTtcblxuLy8gQ2xvc2UgcHJvZmlsZSBlZGl0XG5lZGl0UHJvZmlsZUNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59KTtcblxuLy8gT3BlbiBuZXcgcG9zdFxubmV3UG9zdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwobmV3UG9zdE1vZGFsKTtcbn0pO1xuXG4vLyBDbG9zZSBuZXcgcG9zdFxubmV3UG9zdENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcbn0pO1xuXG4vLyBPcGVuIGF2YXRhciBtb2RhbCBmcm9tIGF2YXRhciBidXR0b25cbmlmIChhdmF0YXJFZGl0QnV0dG9uICYmIGF2YXRhck1vZGFsICYmIGF2YXRhckZvcm0gJiYgYXZhdGFyU3VibWl0QnV0dG9uKSB7XG4gIGF2YXRhckVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xuICB9KTtcbn1cblxuLy8gQ2xvc2UgYXZhdGFyIG1vZGFsXG5pZiAoYXZhdGFyQ2xvc2VCdXR0b24pIHtcbiAgYXZhdGFyQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcbiAgfSk7XG59XG5cbi8vIENsb3NlIGRlbGV0ZSBtb2RhbCBmcm9tIFggYnV0dG9uXG5pZiAoZGVsZXRlQ2xvc2VCdXR0b24pIHtcbiAgZGVsZXRlQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcbiAgfSk7XG59XG5cbi8vIENsb3NlIGRlbGV0ZSBtb2RhbCBmcm9tIENhbmNlbCBidXR0b25cbmlmIChjYW5jZWxEZWxldGVCdXR0b24pIHtcbiAgY2FuY2VsRGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG4gIH0pO1xufVxuXG4vLyBDbG9zZSBpbWFnZSBwcmV2aWV3XG5wcmV2aWV3Q2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xufSk7XG5cbi8vIC0tLS0tLS0tLSBJTklUSUFMIERBVEEgTE9BRCAtLS0tLS0tLS1cblxuYXBpXG4gIC5nZXRBcHBJbmZvKClcbiAgLnRoZW4oKFt1c2VyRGF0YSwgaW5pdGlhbENhcmRzXSkgPT4ge1xuICAgIGN1cnJlbnRVc2VySWQgPSB1c2VyRGF0YS5faWQ7XG5cbiAgICBwcm9maWxlTmFtZUVsLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcbiAgICBwcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xuICAgIHByb2ZpbGVBdmF0YXJFbC5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XG5cbiAgICBpbml0aWFsQ2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xuICAgICAgYWRkQ2FyZFRvRW5kKGNhcmQpO1xuICAgIH0pO1xuICB9KVxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG5cbi8vIC0tLS0tLS0tLSBFTkFCTEUgRk9STSBWQUxJREFUSU9OIC0tLS0tLS0tLVxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcbiIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayBzZXJ2ZXIgcmVzcG9uc2VcclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICAvLyBVbml2ZXJzYWwgcmVxdWVzdCBoZWxwZXJcclxuICBfcmVxdWVzdChwYXRoLCBvcHRpb25zID0ge30pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfSR7cGF0aH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIC4uLm9wdGlvbnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG5cclxuICAvLyBMb2FkIHVzZXIgaW5mbyArIGNhcmRzIHRvZ2V0aGVyXHJcbiAgZ2V0QXBwSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0tLS0tLSBVU0VSIE1FVEhPRFMgLS0tLS0tLS1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiKTtcclxuICB9XHJcblxyXG4gIHNldFVwZGF0ZVVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWVcIiwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlQXZhdGFyKGF2YXRhclVybCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBhdmF0YXJVcmwgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLS0tLS0tIENBUkQgTUVUSE9EUyAtLS0tLS0tLVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi9jYXJkc1wiKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL2NhcmRzXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2hhbmdlTGlrZUNhcmRTdGF0dXMoY2FyZElkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgL2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJQVVRcIiA6IFwiREVMRVRFXCIsXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFwaTtcclxuIl0sIm5hbWVzIjpbInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWwiLCJjb25maWciLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJkaXNhYmxlQnV0dG9uIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImJ1dHRvbiIsImRlZmF1bHRUZXh0IiwibG9hZGluZ1RleHQiLCJ0ZXh0Q29udGVudCIsImN1cnJlbnRVc2VySWQiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImFwaSIsImNvbnN0cnVjdG9yIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIl9yZXF1ZXN0IiwicGF0aCIsIm9wdGlvbnMiLCJmZXRjaCIsInRoZW4iLCJnZXRBcHBJbmZvIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJzZXRVcGRhdGVVc2VySW5mbyIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidXBkYXRlQXZhdGFyIiwiYXZhdGFyVXJsIiwiYXZhdGFyIiwiYWRkQ2FyZCIsImxpbmsiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiY2hhbmdlTGlrZUNhcmRTdGF0dXMiLCJpc0xpa2VkIiwiYXV0aG9yaXphdGlvbiIsImVkaXRQcm9maWxlQnV0dG9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZWRpdFByb2ZpbGVNb2RhbCIsImVkaXRQcm9maWxlQ2xvc2VCdXR0b24iLCJlZGl0UHJvZmlsZUZvcm0iLCJlZGl0UHJvZmlsZU5hbWVJbnB1dCIsImVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImVkaXRQcm9maWxlU3VibWl0QnV0dG9uIiwibmV3UG9zdE1vZGFsIiwiYWRkQ2FyZEZvcm1FbCIsIm5ld1Bvc3RDYXB0aW9uSW5wdXQiLCJuZXdQb3N0SW1hZ2VJbnB1dCIsIm5ld1Bvc3RCdXR0b24iLCJjYXJkU3VibWl0QnV0dG9uIiwibmV3UG9zdENsb3NlQnV0dG9uIiwiYXZhdGFyRWRpdEJ1dHRvbiIsInByZXZpZXdNb2RhbCIsInByZXZpZXdDbG9zZUJ0biIsInByZXZpZXdJbWFnZUVsIiwicHJldmlld05hbWVFbCIsInByb2ZpbGVOYW1lRWwiLCJwcm9maWxlRGVzY3JpcHRpb25FbCIsInByb2ZpbGVBdmF0YXJFbCIsImRlbGV0ZU1vZGFsIiwiZGVsZXRlRm9ybSIsImRlbGV0ZVN1Ym1pdEJ1dHRvbiIsImRlbGV0ZUNsb3NlQnV0dG9uIiwiY2FuY2VsRGVsZXRlQnV0dG9uIiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJGb3JtIiwiYXZhdGFySW5wdXQiLCJhdmF0YXJTdWJtaXRCdXR0b24iLCJhdmF0YXJDbG9zZUJ1dHRvbiIsImNhcmRUZW1wbGF0ZSIsImNhcmRzTGlzdCIsImhhbmRsZUVzY2FwZSIsImV2dCIsImtleSIsIm9wZW5lZE1vZGFsIiwiY2xvc2VNb2RhbCIsImhhbmRsZU92ZXJsYXlDbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwib3Blbk1vZGFsIiwibW9kYWwiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImdldENhcmRFbGVtZW50IiwiZGF0YSIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRUaXRsZUVsIiwiY2FyZEltYWdlRWwiLCJsaWtlQnV0dG9uRWwiLCJkZWxldGVCdXR0b25FbCIsInNyYyIsImFsdCIsIm93bmVySWQiLCJvd25lciIsIl9pZCIsInN0eWxlIiwiZGlzcGxheSIsIkJvb2xlYW4iLCJzaG91bGRMaWtlIiwidXBkYXRlZENhcmQiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImhhbmRsZURlbGV0ZUNhcmQiLCJwcmV2ZW50RGVmYXVsdCIsInZhbHVlIiwidXNlckRhdGEiLCJmaW5hbGx5IiwibmV3Q2FyZCIsImNhcmREYXRhIiwicHJlcGVuZCIsImFkZENhcmRUb1N0YXJ0IiwicmVzZXQiLCJpbml0aWFsQ2FyZHMiLCJmb3JFYWNoIiwiY2FyZCIsImFwcGVuZCIsImFkZENhcmRUb0VuZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JtRWwiLCJzZXRFdmVudExpc3RlbmVyIiwiQXJyYXkiLCJmcm9tIiwiaW5wdXRFbCIsImNoZWNrSW5wdXRWYWxpZGl0eSIsImhpZGVJbnB1dEVycm9yIiwiZXJyb3JNc2dFbCIsImlkIiwic2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9