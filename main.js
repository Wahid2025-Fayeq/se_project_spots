!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?(t.disabled=!0,t.classList.add(r.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},r=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)};function n(e,t,r,n){t&&(t.textContent=e?n:r)}let o=null,a=null,l=null;const s=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t={}){return fetch(`${this._baseUrl}${e}`,{headers:this._headers,...t}).then(e=>this._checkResponse(e))}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getUserInfo(){return this._request("/users/me")}setUpdateUserInfo({name:e,about:t}){return this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:e,about:t})})}updateAvatar(e){return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:e})})}getInitialCards(){return this._request("/cards")}addCard({name:e,link:t}){return this._request("/cards",{method:"POST",body:JSON.stringify({name:e,link:t})})}deleteCard(e){return this._request(`/cards/${e}`,{method:"DELETE"})}changeLikeCardStatus(e,t){return this._request(`/cards/${e}/likes`,{method:t?"PUT":"DELETE"})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"cf143ddc-e5b7-44f2-b563-374f81cfb9fa","Content-Type":"application/json"}}),c=document.querySelector(".profile__edit-button"),i=document.querySelector("#edit-profile-modal"),d=i.querySelector(".modal__close-button"),u=i.querySelector(".modal__form"),m=i.querySelector("#profile-name-input"),_=i.querySelector("#profile-description-input"),v=u.querySelector(".modal__submit-button"),S=document.querySelector("#new-post-modal"),y=S.querySelector(".modal__form"),p=S.querySelector("#card-caption-input"),f=S.querySelector("#card-image-input"),b=document.querySelector(".profile__add-button"),q=y.querySelector(".modal__submit-button"),h=S.querySelector(".modal__close-button"),L=document.querySelector(".profile__avatar-button"),E=document.querySelector("#preview-modal"),k=E.querySelector(".modal__close-button"),C=E.querySelector(".modal__image"),g=E.querySelector(".modal__caption"),w=document.querySelector(".profile__name"),x=document.querySelector(".profile__description"),U=document.querySelector(".profile__avatar"),A=document.querySelector("#delete-card-modal"),D=A?A.querySelector(".modal__form"):null,I=D?D.querySelector(".modal__submit-button"):null,B=A?A.querySelector(".modal__close-button"):null,T=document.querySelector("#delete-cancel-button"),$=document.querySelector("#avatar-modal"),P=$?$.querySelector(".modal__form"):null,j=P?P.querySelector("#avatar-link-input"):null,N=P?P.querySelector(".modal__submit-button"):null,O=$?$.querySelector(".modal__close-button"):null,J=document.querySelector("#card-template"),H=document.querySelector(".cards__list");function R(e){if("Escape"===e.key){const e=document.querySelector(".modal_is-opened");e&&M(e)}}function Y(e){e.target.classList.contains("modal")&&M(e.target)}function z(e){e.classList.add("modal_is-opened"),e.addEventListener("mousedown",Y),document.addEventListener("keydown",R)}function M(e){e.classList.remove("modal_is-opened"),e.removeEventListener("mousedown",Y),document.removeEventListener("keydown",R)}function F(e){const t=J.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),c=t.querySelector(".card__link-button"),i=t.querySelector(".card__delete-button");n.src=e.link,n.alt=e.name,r.textContent=e.name;const d=e.owner&&"object"==typeof e.owner?e.owner._id:e.owner;return d&&o&&d!==o&&(i.style.display="none"),Boolean(e.isLiked)&&c.classList.add("card__link-button_active"),c.addEventListener("click",()=>{const t=!c.classList.contains("card__link-button_active");s.changeLikeCardStatus(e._id,t).then(e=>{e.isLiked?c.classList.add("card__link-button_active"):c.classList.remove("card__link-button_active")}).catch(console.error)}),i.addEventListener("click",()=>{!function(e,t){a=e,l=t._id,z(A)}(t,e)}),n.addEventListener("click",()=>{C.src=e.link,g.textContent=e.name,C.alt=e.name,z(E)}),t}var G;u.addEventListener("submit",e=>{e.preventDefault();const t=m.value,r=_.value;n(!0,v,"Save","Saving..."),s.setUpdateUserInfo({name:t,about:r}).then(e=>{w.textContent=e.name,x.textContent=e.about,M(i)}).catch(console.error).finally(()=>{n(!1,v,"Save","Saving...")})}),y.addEventListener("submit",t=>{t.preventDefault();const o=p.value,a=f.value;n(!0,q,"Save","Saving..."),s.addCard({name:o,link:a}).then(t=>{!function(e){const t=F(e);H.prepend(t)}(t),y.reset(),r(q,e),M(S)}).catch(console.error).finally(()=>{n(!1,q,"Save","Saving...")})}),P&&j&&N&&P.addEventListener("submit",t=>{t.preventDefault();const o=j.value;n(!0,N,"Save","Saving..."),s.updateAvatar(o).then(t=>{U.src=t.avatar,P.reset(),r(N,e),M($)}).catch(console.error).finally(()=>{n(!1,N,"Save","Saving...")})}),D&&I&&D.addEventListener("submit",e=>{e.preventDefault(),l&&(n(!0,I,"Yes, delete","Deleting..."),s.deleteCard(l).then(()=>{a&&a.remove(),a=null,l=null,M(A)}).catch(console.error).finally(()=>{n(!1,I,"Yes, delete","Deleting...")}))}),c.addEventListener("click",()=>{m.value=w.textContent,_.value=x.textContent,z(i)}),d.addEventListener("click",()=>{M(i)}),b.addEventListener("click",()=>{y.reset(),r(q,e),z(S)}),h.addEventListener("click",()=>{M(S)}),L&&$&&P&&N&&L.addEventListener("click",()=>{P.reset(),r(N,e),z($)}),O&&O.addEventListener("click",()=>{M($)}),B&&B.addEventListener("click",()=>{M(A)}),T&&T.addEventListener("click",()=>{M(A)}),k.addEventListener("click",()=>{M(E)}),s.getAppInfo().then(([e,t])=>{o=e._id,w.textContent=e.name,x.textContent=e.about,U.src=e.avatar,t.forEach(e=>{!function(e){const t=F(e);H.append(t)}(e)})}).catch(console.error),G=e,document.querySelectorAll(G.formSelector).forEach(e=>{((e,r)=>{const n=Array.from(e.querySelectorAll(r.inputSelector)),o=e.querySelector(r.submitButtonSelector);t(n,o,r),n.forEach(a=>{a.addEventListener("input",()=>{((e,t,r)=>{t.validity.valid?((e,t,r)=>{const n=e.querySelector(`#${t.id}-error`);n&&(n.textContent="",n.classList.remove(r.errorClass)),t.classList.remove(r.inputErrorClass)})(e,t,r):((e,t,r)=>{const n=e.querySelector(`#${t.id}-error`);n&&(n.textContent=t.validationMessage,n.classList.add(r.errorClass)),t.classList.add(r.inputErrorClass)})(e,t,r)})(e,a,r),t(n,o,r)})})})(e,G)})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQVEvSSxVQUFVRSxPQUFPVCxFQUFPTCxrQkFPOUI2SixDQUFlTixFQUFRSSxFQUFTdEosR0F0QmIySixFQUFDVCxFQUFRSSxFQUFTdEosS0FDdkMsTUFBTXlKLEVBQWFQLEVBQU9wRixjQUFlLElBQUd3RixFQUFRSSxZQUNoREQsSUFDRkEsRUFBV3pJLFlBQWNzSSxFQUFRTSxrQkFDakNILEVBQVdsSixVQUFVQyxJQUFJUixFQUFPSixhQUVsQzBKLEVBQVEvSSxVQUFVQyxJQUFJUixFQUFPTCxrQkFjM0JnSyxDQUFlVCxFQUFRSSxFQUFTdEosSUErQjlCdUosQ0FBbUJMLEVBQVFJLEVBQVN0SixHQUNwQ0gsRUFBa0JDLEVBQVdDLEVBQVVDLFFBUXpDbUosQ0FBaUJELEVBQVFsSixJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2VicGFjay1kZW1vLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJwYWNrLWRlbW8vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2VicGFjay1kZW1vLy4vc3JjL3V0aWwvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgaWYgKGVycm9yTXNnRWwpIHtcclxuICAgIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JNc2dFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5lcnJvckNsYXNzKTtcclxuICB9XHJcbiAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgaWYgKGVycm9yTXNnRWwpIHtcclxuICAgIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNc2dFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5lcnJvckNsYXNzKTtcclxuICB9XHJcbiAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcclxuICB9XHJcbn07XHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiAhaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG59O1xyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBidXR0b25FbC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBidXR0b25FbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWwuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIGJ1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxufTtcclxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xyXG4gIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcclxuICBidXR0b25FbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXIgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgY29uc3QgYnV0dG9uRWwgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xyXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XHJcbiAgICBzZXRFdmVudExpc3RlbmVyKGZvcm1FbCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuIiwiaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbC9BcGkuanNcIjtcclxuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7XHJcbiAgdmFsaWRhdGlvbkNvbmZpZyxcclxuICBkaXNhYmxlQnV0dG9uLFxyXG4gIGVuYWJsZVZhbGlkYXRpb24sXHJcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvblwiO1xyXG5cclxuLy8gLS0tLS0tLS0tIEhFTFBFUiBGT1IgXCJTYXZpbmcuLi5cIiAvIFwiRGVsZXRpbmcuLi5cIiAtLS0tLS0tLS1cclxuZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGJ1dHRvbiwgZGVmYXVsdFRleHQsIGxvYWRpbmdUZXh0KSB7XHJcbiAgaWYgKCFidXR0b24pIHJldHVybjtcclxuICBidXR0b24udGV4dENvbnRlbnQgPSBpc0xvYWRpbmcgPyBsb2FkaW5nVGV4dCA6IGRlZmF1bHRUZXh0O1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0gR0xPQkFMIFNUQVRFIC0tLS0tLS0tLVxyXG5sZXQgY3VycmVudFVzZXJJZCA9IG51bGw7XHJcbmxldCBzZWxlY3RlZENhcmQgPSBudWxsO1xyXG5sZXQgc2VsZWN0ZWRDYXJkSWQgPSBudWxsO1xyXG5cclxuLy8gLS0tLS0tLS0tIEFQSSBJTlNUQU5DRSAtLS0tLS0tLS1cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiY2YxNDNkZGMtZTViNy00NGYyLWI1NjMtMzc0ZjgxY2ZiOWZhXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8vIC0tLS0tLS0tLSBET00gRUxFTUVOVFMgLS0tLS0tLS0tXHJcblxyXG4vLyBQcm9maWxlIG1vZGFsXHJcbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZUNsb3NlQnV0dG9uID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIixcclxuKTtcclxuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZU5hbWVJbnB1dCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLW5hbWUtaW5wdXRcIixcclxuKTtcclxuY29uc3QgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIixcclxuKTtcclxuY29uc3QgZWRpdFByb2ZpbGVTdWJtaXRCdXR0b24gPSBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxyXG4pO1xyXG5cclxuLy8gTmV3IHBvc3QgKGNhcmQpIG1vZGFsXHJcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XHJcbmNvbnN0IGFkZENhcmRGb3JtRWwgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgbmV3UG9zdENhcHRpb25JbnB1dCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtY2FwdGlvbi1pbnB1dFwiKTtcclxuY29uc3QgbmV3UG9zdEltYWdlSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLWltYWdlLWlucHV0XCIpO1xyXG5jb25zdCBuZXdQb3N0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCBjYXJkU3VibWl0QnV0dG9uID0gYWRkQ2FyZEZvcm1FbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBuZXdQb3N0Q2xvc2VCdXR0b24gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xyXG5cclxuLy8gQXZhdGFyIGVkaXRcclxuY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ1dHRvblwiKTtcclxuXHJcbi8vIFByZXZpZXcgbW9kYWxcclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xyXG5jb25zdCBwcmV2aWV3Q2xvc2VCdG4gPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xyXG5jb25zdCBwcmV2aWV3SW1hZ2VFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld05hbWVFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5cclxuLy8gUHJvZmlsZSB0ZXh0ICsgYXZhdGFyIG9uIHBhZ2VcclxuY29uc3QgcHJvZmlsZU5hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcclxuXHJcbi8vIERlbGV0ZSBjb25maXJtYXRpb24gcG9wdXBcclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBkZWxldGVGb3JtID0gZGVsZXRlTW9kYWxcclxuICA/IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIilcclxuICA6IG51bGw7XHJcbmNvbnN0IGRlbGV0ZVN1Ym1pdEJ1dHRvbiA9IGRlbGV0ZUZvcm1cclxuICA/IGRlbGV0ZUZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKVxyXG4gIDogbnVsbDtcclxuY29uc3QgZGVsZXRlQ2xvc2VCdXR0b24gPSBkZWxldGVNb2RhbFxyXG4gID8gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgOiBudWxsO1xyXG5jb25zdCBjYW5jZWxEZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYW5jZWwtYnV0dG9uXCIpO1xyXG5cclxuLy8gQXZhdGFyIG1vZGFsXHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XHJcbmNvbnN0IGF2YXRhckZvcm0gPSBhdmF0YXJNb2RhbFxyXG4gID8gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKVxyXG4gIDogbnVsbDtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJGb3JtXHJcbiAgPyBhdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWxpbmstaW5wdXRcIilcclxuICA6IG51bGw7XHJcbmNvbnN0IGF2YXRhclN1Ym1pdEJ1dHRvbiA9IGF2YXRhckZvcm1cclxuICA/IGF2YXRhckZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKVxyXG4gIDogbnVsbDtcclxuY29uc3QgYXZhdGFyQ2xvc2VCdXR0b24gPSBhdmF0YXJNb2RhbFxyXG4gID8gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgOiBudWxsO1xyXG5cclxuLy8gQ2FyZHNcclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xyXG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5cclxuLy8gLS0tLS0tLS0tIE1PREFMIEhFTFBFUlMgLS0tLS0tLS0tXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9pcy1vcGVuZWRcIik7XHJcbiAgICBpZiAob3BlbmVkTW9kYWwpIHtcclxuICAgICAgY2xvc2VNb2RhbChvcGVuZWRNb2RhbCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVPdmVybGF5Q2xvc2UoZXZ0KSB7XHJcbiAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcclxuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xyXG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgaGFuZGxlT3ZlcmxheUNsb3NlKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX2lzLW9wZW5lZFwiKTtcclxuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZU92ZXJsYXlDbG9zZSk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKTtcclxufVxyXG5cclxuLy8gLS0tLS0tLS0tIENBUkQgSEVMUEVSUyAtLS0tLS0tLS1cclxuXHJcbi8vIEZvciB0aGlzIEFQSSwgaXNMaWtlZCBpcyBhIGJvb2xlYW4gb24gdGhlIGNhcmQgb2JqZWN0XHJcbmZ1bmN0aW9uIGlzQ2FyZExpa2VkKGNhcmQpIHtcclxuICByZXR1cm4gQm9vbGVhbihjYXJkLmlzTGlrZWQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhKSB7XHJcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgc2VsZWN0ZWRDYXJkSWQgPSBkYXRhLl9pZDtcclxuICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgY29uc3QgY2FyZFRpdGxlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICBjb25zdCBsaWtlQnV0dG9uRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpbmstYnV0dG9uXCIpO1xyXG4gIGNvbnN0IGRlbGV0ZUJ1dHRvbkVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG5cclxuICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgY2FyZEltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gIGNhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG5cclxuICAvLyBPd25lciBtYXkgYmUgYW4gSUQgc3RyaW5nIG9yIGFuIG9iamVjdCwgaGFuZGxlIGJvdGggZGVmZW5zaXZlbHlcclxuICBjb25zdCBvd25lcklkID1cclxuICAgIGRhdGEub3duZXIgJiYgdHlwZW9mIGRhdGEub3duZXIgPT09IFwib2JqZWN0XCIgPyBkYXRhLm93bmVyLl9pZCA6IGRhdGEub3duZXI7XHJcblxyXG4gIGlmIChvd25lcklkICYmIGN1cnJlbnRVc2VySWQgJiYgb3duZXJJZCAhPT0gY3VycmVudFVzZXJJZCkge1xyXG4gICAgZGVsZXRlQnV0dG9uRWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIH1cclxuXHJcbiAgaWYgKGlzQ2FyZExpa2VkKGRhdGEpKSB7XHJcbiAgICBsaWtlQnV0dG9uRWwuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpbmstYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIGxpa2VCdXR0b25FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY29uc3Qgc2hvdWxkTGlrZSA9ICFsaWtlQnV0dG9uRWwuY2xhc3NMaXN0LmNvbnRhaW5zKFxyXG4gICAgICBcImNhcmRfX2xpbmstYnV0dG9uX2FjdGl2ZVwiLFxyXG4gICAgKTtcclxuXHJcbiAgICBhcGlcclxuICAgICAgLmNoYW5nZUxpa2VDYXJkU3RhdHVzKGRhdGEuX2lkLCBzaG91bGRMaWtlKVxyXG4gICAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgICBpZiAodXBkYXRlZENhcmQuaXNMaWtlZCkge1xyXG4gICAgICAgICAgbGlrZUJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saW5rLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxpa2VCdXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGluay1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gIH0pO1xyXG5cclxuICBkZWxldGVCdXR0b25FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSk7XHJcbiAgfSk7XHJcblxyXG4gIGNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBwcmV2aWV3SW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICBwcmV2aWV3TmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgcHJldmlld0ltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkQ2FyZFRvU3RhcnQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmREYXRhKTtcclxuICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZENhcmRUb0VuZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZERhdGEpO1xyXG4gIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0gRk9STSBIQU5ETEVSUyAtLS0tLS0tLS1cclxuXHJcbi8vIEVkaXQgcHJvZmlsZVxyXG5lZGl0UHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGNvbnN0IG5hbWUgPSBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZTtcclxuICBjb25zdCBhYm91dCA9IGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZTtcclxuXHJcbiAgcmVuZGVyTG9hZGluZyh0cnVlLCBlZGl0UHJvZmlsZVN1Ym1pdEJ1dHRvbiwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xyXG5cclxuICBhcGlcclxuICAgIC5zZXRVcGRhdGVVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pXHJcbiAgICAudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZU5hbWVFbC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWU7XHJcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbkVsLnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgICAgIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIGVkaXRQcm9maWxlU3VibWl0QnV0dG9uLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG4vLyBBZGQgbmV3IGNhcmRcclxuYWRkQ2FyZEZvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3QgbmFtZSA9IG5ld1Bvc3RDYXB0aW9uSW5wdXQudmFsdWU7XHJcbiAgY29uc3QgbGluayA9IG5ld1Bvc3RJbWFnZUlucHV0LnZhbHVlO1xyXG5cclxuICByZW5kZXJMb2FkaW5nKHRydWUsIGNhcmRTdWJtaXRCdXR0b24sIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcclxuXHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSlcclxuICAgIC50aGVuKChuZXdDYXJkKSA9PiB7XHJcbiAgICAgIGFkZENhcmRUb1N0YXJ0KG5ld0NhcmQpO1xyXG4gICAgICBhZGRDYXJkRm9ybUVsLnJlc2V0KCk7XHJcbiAgICAgIGRpc2FibGVCdXR0b24oY2FyZFN1Ym1pdEJ1dHRvbiwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICAgIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgY2FyZFN1Ym1pdEJ1dHRvbiwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuLy8gVXBkYXRlIGF2YXRhclxyXG5pZiAoYXZhdGFyRm9ybSAmJiBhdmF0YXJJbnB1dCAmJiBhdmF0YXJTdWJtaXRCdXR0b24pIHtcclxuICBhdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgY29uc3QgYXZhdGFyVXJsID0gYXZhdGFySW5wdXQudmFsdWU7XHJcblxyXG4gICAgcmVuZGVyTG9hZGluZyh0cnVlLCBhdmF0YXJTdWJtaXRCdXR0b24sIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcclxuXHJcbiAgICBhcGlcclxuICAgICAgLnVwZGF0ZUF2YXRhcihhdmF0YXJVcmwpXHJcbiAgICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICAgIHByb2ZpbGVBdmF0YXJFbC5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XHJcbiAgICAgICAgYXZhdGFyRm9ybS5yZXNldCgpO1xyXG4gICAgICAgIGRpc2FibGVCdXR0b24oYXZhdGFyU3VibWl0QnV0dG9uLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICAgICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBhdmF0YXJTdWJtaXRCdXR0b24sIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcclxuICAgICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vIERlbGV0ZSBjYXJkIChjb25maXJtKVxyXG5pZiAoZGVsZXRlRm9ybSAmJiBkZWxldGVTdWJtaXRCdXR0b24pIHtcclxuICBkZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAoIXNlbGVjdGVkQ2FyZElkKSByZXR1cm47XHJcblxyXG4gICAgcmVuZGVyTG9hZGluZyh0cnVlLCBkZWxldGVTdWJtaXRCdXR0b24sIFwiWWVzLCBkZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcclxuXHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBpZiAoc2VsZWN0ZWRDYXJkKSB7XHJcbiAgICAgICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGVjdGVkQ2FyZCA9IG51bGw7XHJcbiAgICAgICAgc2VsZWN0ZWRDYXJkSWQgPSBudWxsO1xyXG4gICAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIGRlbGV0ZVN1Ym1pdEJ1dHRvbiwgXCJZZXMsIGRlbGV0ZVwiLCBcIkRlbGV0aW5nLi4uXCIpO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuLy8gLS0tLS0tLS0tIEJVVFRPTiAvIE1PREFMIE9QRU4gJiBDTE9TRSBMSVNURU5FUlMgLS0tLS0tLS0tXHJcblxyXG4vLyBPcGVuIHByb2ZpbGUgZWRpdFxyXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRQcm9maWxlTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWVFbC50ZXh0Q29udGVudDtcclxuICBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudDtcclxuICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbn0pO1xyXG5cclxuLy8gQ2xvc2UgcHJvZmlsZSBlZGl0XHJcbmVkaXRQcm9maWxlQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xyXG59KTtcclxuXHJcbi8vIE9wZW4gbmV3IHBvc3RcclxubmV3UG9zdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZENhcmRGb3JtRWwucmVzZXQoKTtcclxuICBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdXR0b24sIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIG9wZW5Nb2RhbChuZXdQb3N0TW9kYWwpO1xyXG59KTtcclxuXHJcbi8vIENsb3NlIG5ldyBwb3N0XHJcbm5ld1Bvc3RDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcclxufSk7XHJcblxyXG4vLyBPcGVuIGF2YXRhciBtb2RhbCBmcm9tIGF2YXRhciBidXR0b25cclxuaWYgKGF2YXRhckVkaXRCdXR0b24gJiYgYXZhdGFyTW9kYWwgJiYgYXZhdGFyRm9ybSAmJiBhdmF0YXJTdWJtaXRCdXR0b24pIHtcclxuICBhdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBhdmF0YXJGb3JtLnJlc2V0KCk7XHJcbiAgICBkaXNhYmxlQnV0dG9uKGF2YXRhclN1Ym1pdEJ1dHRvbiwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vLyBDbG9zZSBhdmF0YXIgbW9kYWxcclxuaWYgKGF2YXRhckNsb3NlQnV0dG9uKSB7XHJcbiAgYXZhdGFyQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vLyBDbG9zZSBkZWxldGUgbW9kYWwgZnJvbSBYIGJ1dHRvblxyXG5pZiAoZGVsZXRlQ2xvc2VCdXR0b24pIHtcclxuICBkZWxldGVDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vIENsb3NlIGRlbGV0ZSBtb2RhbCBmcm9tIENhbmNlbCBidXR0b25cclxuaWYgKGNhbmNlbERlbGV0ZUJ1dHRvbikge1xyXG4gIGNhbmNlbERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vIENsb3NlIGltYWdlIHByZXZpZXdcclxucHJldmlld0Nsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xyXG59KTtcclxuXHJcbi8vIC0tLS0tLS0tLSBJTklUSUFMIERBVEEgTE9BRCAtLS0tLS0tLS1cclxuXHJcbmFwaVxyXG4gIC5nZXRBcHBJbmZvKClcclxuICAudGhlbigoW3VzZXJEYXRhLCBpbml0aWFsQ2FyZHNdKSA9PiB7XHJcbiAgICBjdXJyZW50VXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG5cclxuICAgIHByb2ZpbGVOYW1lRWwudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuICAgIHByb2ZpbGVBdmF0YXJFbC5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XHJcblxyXG4gICAgaW5pdGlhbENhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcclxuICAgICAgYWRkQ2FyZFRvRW5kKGNhcmQpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG4vLyAtLS0tLS0tLS0gRU5BQkxFIEZPUk0gVkFMSURBVElPTiAtLS0tLS0tLS1cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIHNlcnZlciByZXNwb25zZVxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIC8vIFVuaXZlcnNhbCByZXF1ZXN0IGhlbHBlclxyXG4gIF9yZXF1ZXN0KHBhdGgsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9JHtwYXRofWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgLi4ub3B0aW9ucyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIC8vIExvYWQgdXNlciBpbmZvICsgY2FyZHMgdG9nZXRoZXJcclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG4gIC8vIC0tLS0tLS0tIFVTRVIgTUVUSE9EUyAtLS0tLS0tLVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL3VzZXJzL21lXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0VXBkYXRlVXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIoYXZhdGFyVXJsKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZS9hdmF0YXJcIiwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IGF2YXRhclVybCB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tLS0tLS0gQ0FSRCBNRVRIT0RTIC0tLS0tLS0tXHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL2NhcmRzXCIpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvY2FyZHNcIiwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGxpbmsgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgL2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VMaWtlQ2FyZFN0YXR1cyhjYXJkSWQsIGlzTGlrZWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAvY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIlBVVFwiIDogXCJERUxFVEVcIixcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iXSwibmFtZXMiOlsidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbCIsImNvbmZpZyIsInNvbWUiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlZCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImRpc2FibGVCdXR0b24iLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiYnV0dG9uIiwiZGVmYXVsdFRleHQiLCJsb2FkaW5nVGV4dCIsInRleHRDb250ZW50IiwiY3VycmVudFVzZXJJZCIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElkIiwiYXBpIiwiY29uc3RydWN0b3IiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJwYXRoIiwib3B0aW9ucyIsImZldGNoIiwidGhlbiIsImdldEFwcEluZm8iLCJhbGwiLCJnZXRVc2VySW5mbyIsImdldEluaXRpYWxDYXJkcyIsInNldFVwZGF0ZVVzZXJJbmZvIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXJVcmwiLCJhdmF0YXIiLCJhZGRDYXJkIiwibGluayIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJjaGFuZ2VMaWtlQ2FyZFN0YXR1cyIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJlZGl0UHJvZmlsZU1vZGFsIiwiZWRpdFByb2ZpbGVDbG9zZUJ1dHRvbiIsImVkaXRQcm9maWxlRm9ybSIsImVkaXRQcm9maWxlTmFtZUlucHV0IiwiZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiZWRpdFByb2ZpbGVTdWJtaXRCdXR0b24iLCJuZXdQb3N0TW9kYWwiLCJhZGRDYXJkRm9ybUVsIiwibmV3UG9zdENhcHRpb25JbnB1dCIsIm5ld1Bvc3RJbWFnZUlucHV0IiwibmV3UG9zdEJ1dHRvbiIsImNhcmRTdWJtaXRCdXR0b24iLCJuZXdQb3N0Q2xvc2VCdXR0b24iLCJhdmF0YXJFZGl0QnV0dG9uIiwicHJldmlld01vZGFsIiwicHJldmlld0Nsb3NlQnRuIiwicHJldmlld0ltYWdlRWwiLCJwcmV2aWV3TmFtZUVsIiwicHJvZmlsZU5hbWVFbCIsInByb2ZpbGVEZXNjcmlwdGlvbkVsIiwicHJvZmlsZUF2YXRhckVsIiwiZGVsZXRlTW9kYWwiLCJkZWxldGVGb3JtIiwiZGVsZXRlU3VibWl0QnV0dG9uIiwiZGVsZXRlQ2xvc2VCdXR0b24iLCJjYW5jZWxEZWxldGVCdXR0b24iLCJhdmF0YXJNb2RhbCIsImF2YXRhckZvcm0iLCJhdmF0YXJJbnB1dCIsImF2YXRhclN1Ym1pdEJ1dHRvbiIsImF2YXRhckNsb3NlQnV0dG9uIiwiY2FyZFRlbXBsYXRlIiwiY2FyZHNMaXN0IiwiaGFuZGxlRXNjYXBlIiwiZXZ0Iiwia2V5Iiwib3BlbmVkTW9kYWwiLCJjbG9zZU1vZGFsIiwiaGFuZGxlT3ZlcmxheUNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJvcGVuTW9kYWwiLCJtb2RhbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZ2V0Q2FyZEVsZW1lbnQiLCJkYXRhIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZFRpdGxlRWwiLCJjYXJkSW1hZ2VFbCIsImxpa2VCdXR0b25FbCIsImRlbGV0ZUJ1dHRvbkVsIiwic3JjIiwiYWx0Iiwib3duZXJJZCIsIm93bmVyIiwiX2lkIiwic3R5bGUiLCJkaXNwbGF5IiwiQm9vbGVhbiIsInNob3VsZExpa2UiLCJ1cGRhdGVkQ2FyZCIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiaGFuZGxlRGVsZXRlQ2FyZCIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJ1c2VyRGF0YSIsImZpbmFsbHkiLCJuZXdDYXJkIiwiY2FyZERhdGEiLCJwcmVwZW5kIiwiYWRkQ2FyZFRvU3RhcnQiLCJyZXNldCIsImluaXRpYWxDYXJkcyIsImZvckVhY2giLCJjYXJkIiwiYXBwZW5kIiwiYWRkQ2FyZFRvRW5kIiwicXVlcnlTZWxlY3RvckFsbCIsImZvcm1FbCIsInNldEV2ZW50TGlzdGVuZXIiLCJBcnJheSIsImZyb20iLCJpbnB1dEVsIiwiY2hlY2tJbnB1dFZhbGlkaXR5IiwiaGlkZUlucHV0RXJyb3IiLCJlcnJvck1zZ0VsIiwiaWQiLCJzaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=